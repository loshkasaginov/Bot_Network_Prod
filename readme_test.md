# Проект "Сеть чат-ботов для оптимизации процессов"

## Описание проекта

Проект представляет собой сеть чат-ботов, интегрированных с серверной частью, предназначенную для оптимизации внутренних процессов компании, занимающейся ремонтом оргтехники. Документация разделена на описание структуры, бизнес логики, frontend и backend частей проекта.

### 1. Структура и бизнес-логика

Основная цель проекта — создание эффективного интерфейса для взаимодействия между кураторами, инженерами и стационарными инженерами. Суперюзеры могут управлять кураторами, а кураторы, в свою очередь, управляют инженерами и стационарными инженерами. Основная сущность проекта — заказ (Order), который проходит через следующие стадии:

1. **Согласование** - Инженеры предлагают варианты и стоимость работ, документируют сумму договора или отказа с его причинами.
2. **Предоплата** - Фиксация суммы предоплаты, полученной от клиента.
3. **Стационар** - Передача заказа в стационар с фотографией, описанием и сроками выполнения.
4. **Оприход** - Документирование всех расходов на починку, включая чеки.
5. **Отчет** - Подведение итогов финансовых результатов работы, приложение фотографии договора.

Стадии "Стационар" и "Оприход" являются необязательными и могут быть исключены из процесса в зависимости от специфики заказа.

### 2. Frontend

#### Используемые технологии и библиотеки:
- **Aiogram**: Библиотека для асинхронной разработки Telegram-ботов.
- **SQLite**: Легкая база данных для хранения токенов доступа и обновления.
- **Logger**: Встроенная библиотека для логирования.
- **aiohttp**: Библиотека для асинхронной работы с HTTP-запросами.

#### Логика работы:
- Кураторы инициируют заказы, назначают и контролируют инженеров через все стадии заказа. Инженеры и стационарные инженеры выполняют свои задачи в соответствии с назначениями и документируют все операции. Система обеспечивает верификацию на каждом шаге для подтверждения выполнения задач.

### Логика заказа

Процесс управления заказами структурирован для обеспечения последовательности и контроля на каждом этапе. Система разработана таким образом, чтобы каждый шаг мог быть верифицирован и подтвержден куратором перед переходом к следующему, обеспечивая таким образом полный контроль и трассируемость выполнения заказов.

1. **Инициация заказа**: Куратор инициирует заказ, внося в систему номер заказа и имя инженера, ответственного за его выполнение.
2. **Согласование работ**: Инженер формирует предложение по выполнению работ, которое включает перечень необходимых операций и их стоимость.
3. **Подтверждение согласования**: Куратор оценивает предложение инженера и либо одобряет его, либо отклоняет, предоставляя инженеру возможность его пересмотреть.
4. **Фиксация предоплаты**: Инженер регистрирует полученную от клиента предоплату.
5. **Проверка предоплаты**: Куратор верифицирует внесенные данные о предоплате.
6. **Передача в стационар**: Инженер перенаправляет заказ в стационарный отдел, где его берут в работу стационарные инженеры.
7. **Управление стационарными заказами**: Стационарные инженеры видят все активные заказы и могут выбирать их для выполнения.
8. **Изменение приоритетов**: Куратор может корректировать приоритеты заказов в стационаре для оптимизации загрузки ресурсов.
9. **Отчет по стационару**: По завершении работ в стационаре, стационарный инженер формирует отчет и фиксирует стоимость своих услуг. Заказ возвращается инженеру.
10. **Оприход материалов и услуг**: Инженер документирует все расходы, связанные с заказом.
11. **Верификация расходов**: Куратор проверяет правильность учета расходов.
12. **Финальный отчет**: Инженер подготавливает финальный финансовый отчет по заказу.
13. **Подтверждение финального отчета**: Куратор проверяет и подтверждает финальный отчет, завершая процесс обработки заказа.

Стадии стационара и оприхода являются опциональными и могут быть опущены, если они не применимы к конкретному заказу.

### 3. Backend

#### Используемые технологии и инструменты:
- **FastAPI**: Основа для асинхронного сервера.
- **PostgreSQL**: Реляционная база данных для управления всеми данными проекта.
- **Pytest**: Инструмент для написания асинхронных модульных тестов.
- **Redis**: NoSQL база данных для кеширования, ускоряет обработку данных.
- **Centry**: Инструмент для логирования.
- **OAuth2**: Система аутентификации через JWT-токены.

[Схема базы данных проекта](https://github.com/loshkasaginov/Bot_Network_Prod/assets/84158585/6172d28d-278a-4e6d-9a28-67503309dfa5)

